# wikibase-rest-api-ts

Typescript model and API code for interacting with the REST API of a Wikibase instance (like Wikidata).

## Usage

Read the [official OpenAPI specification for the Wikibase REST API at this link](https://doc.wikimedia.org/Wikibase/master/js/rest-api/).
Depending on the tags of the method you want to use, initialize an object of the relevant API class and call the appropriate method:
- [`AliasesApi`](src/generated/apis/AliasesApi.ts)
- [`DescriptionsApi`](src/generated/apis/DescriptionsApi.ts)
- [`ItemsApi`](src/generated/apis/ItemsApi.ts)
- [`LabelsApi`](src/generated/apis/LabelsApi.ts)
- [`PropertiesApi`](src/generated/apis/PropertiesApi.ts)
- [`SitelinksApi`](src/generated/apis/SitelinksApi.ts)
- [`StatementsApi`](src/generated/apis/StatementsApi.ts)

### Example

Suppose you want to get the label of [Wikidata item Q1](https://www.wikidata.org/wiki/Q1) in english, from [the OpenAPI specification](https://doc.wikimedia.org/Wikibase/master/js/rest-api/) you you find out that the appropriate method is `/entities/items/{item_id}/labels`, under the tag `labels`.

```js
import { LabelsApi } from "wikibase-rest-api-ts";
const api = new LabelsApi();
api.getItemLabel({
        itemId: "Q1", languageCode: "en"
    }).then(
        label => console.log(`English label for Q1 is ${label}`)
    );
```

Suppose instead you want to get the description for an entity on another Wikibase instance, you can use `/entities/items/{item_id}/descriptions/{language_code}` under the `descriptions` tag:
```js
import { Configuration, DescriptionsApi } from "wikibase-rest-api-ts";
const api = new DescriptionsApi(new Configuration({
        basePath: "https://url-to-my-wikibase-instance/w/rest.php/wikibase/v0",
    }));
api.getItemDescription({
        itemId: "Q1", languageCode: "en"
    }).then(
        label => console.log(`English description for Q1 is ${label}`)
    );
```

# Further info

About this repository:
- [openapi.json](openapi.json): Local OpenAPI definition of the API, cloned [from the official one](https://www.wikidata.org/w/rest.php/wikibase/v0/openapi.json) and adapted to work with OpenAPI generator (all structures that are referenced through `~1` or `/allOf/` are extracted inside `#/components/schemas/` and referenced directly)
- [src/generated](src/generated): Typescript API code, autogenerated with OpenAPI-generator from the above specification through `npm run generate`
  - At the time of writing this, OpenAPI generator introduces a bug in the generated code solvable with `npm run fix`
- [src/test](src/test) includes some manually written tests for the code, runnable through `npm test`
- [tsup.config.ts](tsup.config.ts) includes the configuration to transpile the autogenerated Typescript code into the packaged Javascript files in the dist folder with `npm run build`
- The autogenerated and output code can be cleaned up with `npm run clean`

About the Wikibase REST API:
- [Official Swagger explorer for the OpenAPI definition](https://doc.wikimedia.org/Wikibase/master/js/rest-api/)
- [Official documentation about Wikibase REST API](https://www.wikidata.org/wiki/Wikidata:REST_API)
- [Development details about the API](https://doc.wikimedia.org/Wikibase/master/php/repo_rest-api_README.html)
